(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function l(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();const re=(e,n)=>e===n,ue=Symbol("solid-track"),M={equals:re};let fe=se;const E=1,U=2,Z={owned:null,cleanups:null,context:null,owner:null};var m=null;let K=null,h=null,v=null,C=null,D=0;function B(e,n){const t=h,l=m,s=e.length===0,i=s?Z:{owned:null,cleanups:null,context:null,owner:n===void 0?l:n},u=s?e:()=>e(()=>_(()=>J(i)));m=i,h=null;try{return I(u,!0)}finally{h=t,m=l}}function O(e,n){n=n?Object.assign({},M,n):M;const t={value:e,observers:null,observerSlots:null,comparator:n.equals||void 0},l=s=>(typeof s=="function"&&(s=s(t.value)),ee(t,s));return[z.bind(t),l]}function P(e,n,t){const l=te(e,n,!1,E);F(l)}function R(e,n,t){t=t?Object.assign({},M,t):M;const l=te(e,n,!0,0);return l.observers=null,l.observerSlots=null,l.comparator=t.equals||void 0,F(l),z.bind(l)}function _(e){if(h===null)return e();const n=h;h=null;try{return e()}finally{h=n}}function ce(e){return m===null||(m.cleanups===null?m.cleanups=[e]:m.cleanups.push(e)),e}function z(){if(this.sources&&this.state)if(this.state===E)F(this);else{const e=v;v=null,I(()=>j(this),!1),v=e}if(h){const e=this.observers?this.observers.length:0;h.sources?(h.sources.push(this),h.sourceSlots.push(e)):(h.sources=[this],h.sourceSlots=[e]),this.observers?(this.observers.push(h),this.observerSlots.push(h.sources.length-1)):(this.observers=[h],this.observerSlots=[h.sources.length-1])}return this.value}function ee(e,n,t){let l=e.value;return(!e.comparator||!e.comparator(l,n))&&(e.value=n,e.observers&&e.observers.length&&I(()=>{for(let s=0;s<e.observers.length;s+=1){const i=e.observers[s],u=K&&K.running;u&&K.disposed.has(i),(u?!i.tState:!i.state)&&(i.pure?v.push(i):C.push(i),i.observers&&le(i)),u||(i.state=E)}if(v.length>1e6)throw v=[],new Error},!1)),n}function F(e){if(!e.fn)return;J(e);const n=m,t=h,l=D;h=m=e,ae(e,e.value,l),h=t,m=n}function ae(e,n,t){let l;try{l=e.fn(n)}catch(s){return e.pure&&(e.state=E,e.owned&&e.owned.forEach(J),e.owned=null),e.updatedAt=t+1,ie(s)}(!e.updatedAt||e.updatedAt<=t)&&(e.updatedAt!=null&&"observers"in e?ee(e,l):e.value=l,e.updatedAt=t)}function te(e,n,t,l=E,s){const i={fn:e,state:l,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:n,owner:m,context:null,pure:t};return m===null||m!==Z&&(m.owned?m.owned.push(i):m.owned=[i]),i}function ne(e){if(e.state===0)return;if(e.state===U)return j(e);if(e.suspense&&_(e.suspense.inFallback))return e.suspense.effects.push(e);const n=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<D);)e.state&&n.push(e);for(let t=n.length-1;t>=0;t--)if(e=n[t],e.state===E)F(e);else if(e.state===U){const l=v;v=null,I(()=>j(e,n[0]),!1),v=l}}function I(e,n){if(v)return e();let t=!1;n||(v=[]),C?t=!0:C=[],D++;try{const l=e();return de(t),l}catch(l){t||(C=null),v=null,ie(l)}}function de(e){if(v&&(se(v),v=null),e)return;const n=C;C=null,n.length&&I(()=>fe(n),!1)}function se(e){for(let n=0;n<e.length;n++)ne(e[n])}function j(e,n){e.state=0;for(let t=0;t<e.sources.length;t+=1){const l=e.sources[t];if(l.sources){const s=l.state;s===E?l!==n&&(!l.updatedAt||l.updatedAt<D)&&ne(l):s===U&&j(l,n)}}}function le(e){for(let n=0;n<e.observers.length;n+=1){const t=e.observers[n];t.state||(t.state=U,t.pure?v.push(t):C.push(t),t.observers&&le(t))}}function J(e){let n;if(e.sources)for(;e.sources.length;){const t=e.sources.pop(),l=e.sourceSlots.pop(),s=t.observers;if(s&&s.length){const i=s.pop(),u=t.observerSlots.pop();l<s.length&&(i.sourceSlots[u]=l,s[l]=i,t.observerSlots[l]=u)}}if(e.owned){for(n=e.owned.length-1;n>=0;n--)J(e.owned[n]);e.owned=null}if(e.cleanups){for(n=e.cleanups.length-1;n>=0;n--)e.cleanups[n]();e.cleanups=null}e.state=0,e.context=null}function ie(e){throw e}const pe=Symbol("fallback");function H(e){for(let n=0;n<e.length;n++)e[n]()}function he(e,n,t={}){let l=[],s=[],i=[],u=0,o=n.length>1?[]:null;return ce(()=>H(i)),()=>{let a=e()||[],f,r;return a[ue],_(()=>{let p=a.length,w,x,A,d,b,g,y,S,L;if(p===0)u!==0&&(H(i),i=[],l=[],s=[],u=0,o&&(o=[])),t.fallback&&(l=[pe],s[0]=B(oe=>(i[0]=oe,t.fallback())),u=1);else if(u===0){for(s=new Array(p),r=0;r<p;r++)l[r]=a[r],s[r]=B(c);u=p}else{for(A=new Array(p),d=new Array(p),o&&(b=new Array(p)),g=0,y=Math.min(u,p);g<y&&l[g]===a[g];g++);for(y=u-1,S=p-1;y>=g&&S>=g&&l[y]===a[S];y--,S--)A[S]=s[y],d[S]=i[y],o&&(b[S]=o[y]);for(w=new Map,x=new Array(S+1),r=S;r>=g;r--)L=a[r],f=w.get(L),x[r]=f===void 0?-1:f,w.set(L,r);for(f=g;f<=y;f++)L=l[f],r=w.get(L),r!==void 0&&r!==-1?(A[r]=s[f],d[r]=i[f],o&&(b[r]=o[f]),r=x[r],w.set(L,r)):i[f]();for(r=g;r<p;r++)r in A?(s[r]=A[r],i[r]=d[r],o&&(o[r]=b[r],o[r](r))):s[r]=B(c);s=s.slice(0,u=p),l=a.slice(0)}return s});function c(p){if(i[r]=p,o){const[w,x]=O(r);return o[r]=x,n(a[r],w)}return n(a[r])}}}function T(e,n){return _(()=>e(n||{}))}const ge=e=>`Stale read from <${e}>.`;function V(e){const n="fallback"in e&&{fallback:()=>e.fallback};return R(he(()=>e.each,e.children,n||void 0))}function W(e){const n=e.keyed,t=R(()=>e.when,void 0,{equals:(l,s)=>n?l===s:!l==!s});return R(()=>{const l=t();if(l){const s=e.children;return typeof s=="function"&&s.length>0?_(()=>s(n?l:()=>{if(!_(t))throw ge("Show");return e.when})):s}return e.fallback},void 0,void 0)}function ye(e,n,t){let l=t.length,s=n.length,i=l,u=0,o=0,a=n[s-1].nextSibling,f=null;for(;u<s||o<i;){if(n[u]===t[o]){u++,o++;continue}for(;n[s-1]===t[i-1];)s--,i--;if(s===u){const r=i<l?o?t[o-1].nextSibling:t[i-o]:a;for(;o<i;)e.insertBefore(t[o++],r)}else if(i===o)for(;u<s;)(!f||!f.has(n[u]))&&n[u].remove(),u++;else if(n[u]===t[i-1]&&t[o]===n[s-1]){const r=n[--s].nextSibling;e.insertBefore(t[o++],n[u++].nextSibling),e.insertBefore(t[--i],r),n[s]=t[i]}else{if(!f){f=new Map;let c=o;for(;c<i;)f.set(t[c],c++)}const r=f.get(n[u]);if(r!=null)if(o<r&&r<i){let c=u,p=1,w;for(;++c<s&&c<i&&!((w=f.get(n[c]))==null||w!==r+p);)p++;if(p>r-o){const x=n[u];for(;o<r;)e.insertBefore(t[o++],x)}else e.replaceChild(t[o++],n[u++])}else u++;else n[u++].remove()}}}const Q="_$DX_DELEGATE";function we(e,n,t,l={}){let s;return B(i=>{s=i,n===document?e():$(n,e(),n.firstChild?null:void 0,t)},l.owner),()=>{s(),n.textContent=""}}function k(e,n,t){let l;const s=()=>{const u=document.createElement("template");return u.innerHTML=e,t?u.content.firstChild.firstChild:u.content.firstChild},i=n?()=>_(()=>document.importNode(l||(l=s()),!0)):()=>(l||(l=s())).cloneNode(!0);return i.cloneNode=i,i}function be(e,n=window.document){const t=n[Q]||(n[Q]=new Set);for(let l=0,s=e.length;l<s;l++){const i=e[l];t.has(i)||(t.add(i),n.addEventListener(i,ve))}}function me(e,n,t){t==null?e.removeAttribute(n):e.setAttribute(n,t)}function $(e,n,t,l){if(t!==void 0&&!l&&(l=[]),typeof n!="function")return q(e,n,l,t);P(s=>q(e,n(),s,t),l)}function ve(e){const n=`$$${e.type}`;let t=e.composedPath&&e.composedPath()[0]||e.target;for(e.target!==t&&Object.defineProperty(e,"target",{configurable:!0,value:t}),Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}});t;){const l=t[n];if(l&&!t.disabled){const s=t[`${n}Data`];if(s!==void 0?l.call(t,s,e):l.call(t,e),e.cancelBubble)return}t=t._$host||t.parentNode||t.host}}function q(e,n,t,l,s){for(;typeof t=="function";)t=t();if(n===t)return t;const i=typeof n,u=l!==void 0;if(e=u&&t[0]&&t[0].parentNode||e,i==="string"||i==="number")if(i==="number"&&(n=n.toString()),u){let o=t[0];o&&o.nodeType===3?o.data=n:o=document.createTextNode(n),t=N(e,t,l,o)}else t!==""&&typeof t=="string"?t=e.firstChild.data=n:t=e.textContent=n;else if(n==null||i==="boolean")t=N(e,t,l);else{if(i==="function")return P(()=>{let o=n();for(;typeof o=="function";)o=o();t=q(e,o,t,l)}),()=>t;if(Array.isArray(n)){const o=[],a=t&&Array.isArray(t);if(G(o,n,t,s))return P(()=>t=q(e,o,t,l,!0)),()=>t;if(o.length===0){if(t=N(e,t,l),u)return t}else a?t.length===0?X(e,o,l):ye(e,t,o):(t&&N(e),X(e,o));t=o}else if(n.nodeType){if(Array.isArray(t)){if(u)return t=N(e,t,l,n);N(e,t,null,n)}else t==null||t===""||!e.firstChild?e.appendChild(n):e.replaceChild(n,e.firstChild);t=n}else console.warn("Unrecognized value. Skipped inserting",n)}return t}function G(e,n,t,l){let s=!1;for(let i=0,u=n.length;i<u;i++){let o=n[i],a=t&&t[i],f;if(!(o==null||o===!0||o===!1))if((f=typeof o)=="object"&&o.nodeType)e.push(o);else if(Array.isArray(o))s=G(e,o,a)||s;else if(f==="function")if(l){for(;typeof o=="function";)o=o();s=G(e,Array.isArray(o)?o:[o],Array.isArray(a)?a:[a])||s}else e.push(o),s=!0;else{const r=String(o);a&&a.nodeType===3&&a.data===r?e.push(a):e.push(document.createTextNode(r))}}return s}function X(e,n,t=null){for(let l=0,s=n.length;l<s;l++)e.insertBefore(n[l],t)}function N(e,n,t,l){if(t===void 0)return e.textContent="";const s=l||document.createTextNode("");if(n.length){let i=!1;for(let u=n.length-1;u>=0;u--){const o=n[u];if(s!==o){const a=o.parentNode===e;!i&&!u?a?e.replaceChild(s,o):e.insertBefore(s,t):a&&o.remove()}else i=!0}}else e.insertBefore(s,t);return[s]}const xe=k("<div><div>: Пользователи</div><div></div><div><img>"),Y=k("<div>"),Ae=k('<img src="https://story.artux.net/static/tags/yellow.png">'),Se=({login:e})=>{const[n,t]=O({background:"",id:0,positions:[],title:""}),[l,s]=O(),[i,u]=O(),o=new WebSocket("ws://192.168.1.7:8080/map?id=0&auth="+e),a=f=>{switch(f.key){case"w":var c={...i(),y:i().y+3};break;case"s":var c={...i(),y:i().y-3};break;case"a":var c={...i(),x:i().x-3};break;case"d":var c={...i(),x:i().x+3};break}u(c),o.send(JSON.stringify(c))};return window.addEventListener("keydown",a),o.onmessage=f=>{const r=JSON.parse(f.data),c=JSON.parse(JSON.stringify(l()||{x:500,y:500}));switch(r.type){case"map":console.log("Карта:",r),t(r),u(r.position),s(r.positions);return;case"close":console.log("Пользователь отключился:",r);const p=c?.indexOf(c?.find(x=>x.login===r.login));c.splice(p,1),s(c);return;case"updatePosition":console.log("Обновление позиции:",r);const w=c?.indexOf(c?.find(x=>x.login===r.login));c?.splice(w,1,r),s(c);return;case"newUser":console.log("Новый пользователь:",r),c.push(r),s(c);return}},(()=>{const f=xe(),r=f.firstChild,c=r.firstChild,p=r.nextSibling,w=p.nextSibling,x=w.firstChild;return $(r,()=>n().title,c),$(p,T(V,{get each(){return n().positions},children:A=>(()=>{const d=Y();return $(d,()=>A.login),d})()})),w.style.setProperty("position","relative"),$(w,T(V,{get each(){return l()},children:A=>[(()=>{const d=Y();return d.style.setProperty("position","absolute"),d.style.setProperty("color","white"),d.style.setProperty("mix-blend-mode","difference"),$(d,()=>A.login),P(b=>{const g=A.pos.x+"px",y=A.pos.y+20+"px";return g!==b._v$&&((b._v$=g)!=null?d.style.setProperty("left",g):d.style.removeProperty("left")),y!==b._v$2&&((b._v$2=y)!=null?d.style.setProperty("bottom",y):d.style.removeProperty("bottom")),b},{_v$:void 0,_v$2:void 0}),d})(),(()=>{const d=Ae();return d.style.setProperty("position","absolute"),d.style.setProperty("width","10px"),P(b=>{const g=A.pos.x+"px",y=A.pos.y+"px";return g!==b._v$3&&((b._v$3=g)!=null?d.style.setProperty("left",g):d.style.removeProperty("left")),y!==b._v$4&&((b._v$4=y)!=null?d.style.setProperty("bottom",y):d.style.removeProperty("bottom")),b},{_v$3:void 0,_v$4:void 0}),d})()]}),null),P(()=>me(x,"src",n().background)),f})()},$e=k('<input placeholder="Логин...">'),Ce=k("<button>Войти"),Pe=k("<div>"),_e=()=>{const[e,n]=O(!1),[t,l]=O("user");return(()=>{const s=Pe();return $(s,T(W,{get when(){return!e()},get children(){return[(()=>{const i=$e();return i.addEventListener("change",u=>{l(u.target.value)}),P(()=>i.value=t()),i})(),(()=>{const i=Ce();return i.$$click=()=>n(!0),i})()]}}),null),$(s,T(W,{get when(){return e()},get children(){return T(Se,{get login(){return t()}})}}),null),s})()};be(["click"]);const Ee=document.getElementById("root");we(()=>T(_e,{}),Ee);
